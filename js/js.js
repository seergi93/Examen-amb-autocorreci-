function gestionarXml(e){var t=e.responseXML,a="",n=0;for(i=0;i<10;i++)switch(a=t.getElementsByTagName("type")[i].innerHTML){case"select":crearDivPregunta(i),imprimirTituloPregunta(i,t),imprimirOpcionesSelect(i,t),preguntasSelect.push(i),respuestasSelect.push(parseInt(t.getElementsByTagName("question")[i].getElementsByTagName("answer")[0].innerHTML)),valorRespuestaSelect.push(t.getElementsByTagName("question")[i].getElementsByTagName("option")[respuestasSelect[i]].innerHTML);break;case"text":crearDivPregunta(i),imprimirTituloPregunta(i,t),imprimirCajaText(n,t),n++,preguntasText.push(i),respuestasText.push(parseInt(t.getElementsByTagName("question")[i].getElementsByTagName("answer")[0].innerHTML));break;case"checkbox":crearDivPregunta(i),imprimirTituloPregunta(i,t),imprimirCheckBox(i,t),preguntasCheckBox.push(i),agregarRespuestas(i,t,respuestasCheckBox,valorRespuestasCheckBox);break;case"radio":crearDivPregunta(i),imprimirTituloPregunta(i,t),imprimirRadioButton(i,t),preguntasRadio.push(i),respuestasRadio.push(parseInt(t.getElementsByTagName("question")[i].getElementsByTagName("answer")[0].innerHTML));break;case"select multiple":crearDivPregunta(i),imprimirTituloPregunta(i,t),imprimirSelectMultiple(i,t),preguntasSelectMultiple.push(i),agregarRespuestas(i,t,respuestasSelectMultiple)}imprimirEspacios(3),imprimirBotonCorregir()}function imprimirTituloPregunta(e,t){var a=document.createElement("h3");a.innerHTML=t.getElementsByTagName("title")[e].innerHTML,document.getElementById("pregunta"+e).appendChild(a)}function imprimirOpcionesSelect(e,t){var a=t.getElementsByTagName("question")[e].getElementsByTagName("option").length,n=t.getElementsByTagName("question")[e].getElementsByTagName("option"),r=document.createElement("select");for(r.id="select"+e,document.getElementById("pregunta"+e).appendChild(r),j=0;j<a;j++){var i=document.createElement("option");i.text=n[j].innerHTML,i.value=j,r.options.add(i)}}function imprimirCajaText(e,t){var a=document.createElement("input");a.type="number",a.id="cajaTexto"+e,document.getElementById("pregunta"+i).appendChild(a)}function imprimirCheckBox(e,t){var a=t.getElementsByTagName("question")[e].getElementsByTagName("option").length,n=t.getElementsByTagName("question")[e].getElementsByTagName("option");for(j=0;j<a;j++){var r=document.createElement("label"),i=document.createElement("input");r.innerHTML=n[j].innerHTML,i.type="checkbox",i.name="preg"+e,i.id="preg"+e+"ans"+j,document.getElementById("pregunta"+e).appendChild(i),document.getElementById("pregunta"+e).appendChild(r),document.getElementById("pregunta"+e).appendChild(document.createElement("br"))}}function imprimirRadioButton(e,t){var a=t.getElementsByTagName("question")[e].getElementsByTagName("option").length,n=t.getElementsByTagName("question")[e].getElementsByTagName("option");for(j=0;j<a;j++){var r=document.createElement("input"),i=n[j].innerHTML,s=document.createElement("span");s.innerHTML=i,r.type="radio",r.name="preg"+e,r.id="preg"+e+"ans"+j,document.getElementById("pregunta"+e).appendChild(r),document.getElementById("pregunta"+e).appendChild(s),document.getElementById("pregunta"+e).appendChild(document.createElement("br"))}}function imprimirSelectMultiple(e,t){var a=t.getElementsByTagName("question")[e].getElementsByTagName("option").length,n=t.getElementsByTagName("question")[e].getElementsByTagName("option"),r=document.createElement("select");for(r.multiple="true",j=0;j<a;j++){var i=n[j].innerHTML,s=document.createElement("option");s.innerHTML=i,r.appendChild(s)}document.getElementById("pregunta"+e).appendChild(r)}function imprimirEspacios(e){for(i=0;i<e;i++){var t=document.createElement("br");formContainer.appendChild(t)}}function imprimirBotonCorregir(){var e=document.createElement("input");e.type="submit",e.value="Corregir",formContainer.appendChild(e)}function corregirSelect(){for(i=0;i<preguntasSelect.length;i++){var e=document.getElementById("pregunta"+preguntasSelect[i]).getElementsByTagName("select")[0],t=respuestasSelect[i];e.selectedIndex==t?(darRespuestaHtml("P"+preguntasSelect[i]+": Correcta"),nota+=1):(darRespuestaHtml("P"+preguntasSelect[i]+": Incorrecta"),darRespuestaHtml("La respuesta correcta es: "+valorRespuestaSelect[i]))}}function corregirText(){for(i=0;i<preguntasText.length;i++){var e=document.getElementById("pregunta"+preguntasText[i]).getElementsByTagName("input")[0],t=respuestasText[i];e.value==t?(darRespuestaHtml("P"+preguntasText[i]+": Correcta"),nota+=1):(darRespuestaHtml("P"+preguntasText[i]+": Incorrecta"),darRespuestaHtml("La respota correcta es: "+respuestasText[i]))}}function corregirCheckBox(){for(i=0;i<preguntasCheckBox.length;i++){var e=document.getElementById("pregunta"+preguntasCheckBox[i]).getElementsByTagName("input"),t=0;for(j=0;j<e.length;j++){var a=!1;if(e[j].checked){for(t=1,k=0;k<respuestasCheckBox[i].length;k++)if(j==respuestasCheckBox[i][k]){nota+=1/respuestasCheckBox[i].length,darRespuestaHtml("P"+preguntasCheckBox[i]+" opcio "+j+": correcta"),a=!0;break}a||(nota-=1/respuestasCheckBox[i].length,darRespuestaHtml("P"+preguntasCheckBox[i]+" opcio "+j+": incorrecta"))}}0==t&&darRespuestaHtml("P"+preguntasCheckBox[i]+": No has seleccionat cap resposta")}}function corregirRadio(){for(i=0;i<preguntasRadio.length;i++){var e=document.getElementById("pregunta"+preguntasRadio[i]),t=0;for(j=0;j<e.getElementsByTagName("input").length;j++)e.getElementsByTagName("input")[j].checked&&(t=1,j==respuestasRadio[i]?(nota+=1,darRespuestaHtml("P"+preguntasRadio[i]+" opcio "+j+": correcta")):(nota-=1,darRespuestaHtml("P"+preguntasRadio[i]+" opcio "+j+": incorrecta")));0==t&&darRespuestaHtml("P"+preguntasRadio[i]+": No has seleccionat cap resposta")}}function corregirSelectMultiple(){for(i=0;i<preguntasSelectMultiple.length;i++){var e=document.getElementById("pregunta"+preguntasSelectMultiple[i]).getElementsByTagName("select")[0],t=0;for(j=0;j<e.length;j++){var a=!1;if(e[j].selected){for(t=1,k=0;k<respuestasSelectMultiple[i].length;k++)if(j==respuestasSelectMultiple[i][k]){nota+=1/respuestasSelectMultiple[i].length,darRespuestaHtml("P"+preguntasSelectMultiple[i]+" opcio "+j+": correcta"),a=!0;break}a||(nota-=1/respuestasSelectMultiple[i].length,darRespuestaHtml("P"+preguntasSelectMultiple[i]+" opcio "+j+": incorrecta"))}}0==t&&darRespuestaHtml("P"+preguntasSelectMultiple[i]+": No has seleccionat cap resposta")}}function agregarRespuestas(e,t,a,n){var r=[];for(j=0;j<t.getElementsByTagName("question")[e].getElementsByTagName("answer").length;j++)r.push(parseInt(t.getElementsByTagName("question")[e].getElementsByTagName("answer")[j].innerHTML));a.push(r)}function crearDivPregunta(e){var t=document.createElement("div");t.id="pregunta"+e,formContainer.appendChild(t)}function inicializar(){document.getElementById("resultadosDiv").innerHTML="",nota=0}function darRespuestaHtml(e){var t=document.createElement("p"),a=document.createTextNode(e);t.appendChild(a),document.getElementById("resultadosDiv").appendChild(t)}function imagenNota(){if(5>nota){var e=document.createElement("img");e.setAttribute("src","img/suspes.png");var t=document.getElementById("resultadosDiv");t.appendChild(e)}else{var e=document.createElement("img");e.setAttribute("src","img/aprovat.png");var t=document.getElementById("resultadosDiv");t.appendChild(e)}}function presentarNota(){imagenNota(),darRespuestaHtml("Nota: "+nota.toFixed(2)+" punts sobre 10")}function comprobar(){for(i=0;i<preguntasText.length;i++){var e=document.getElementById("pregunta"+preguntasText[i]).getElementsByTagName("input")[0];if(""==e.value)return e.focus(),alert("Escriu un numero a la pregunta "+preguntasText[i]),!1}return!0}var formContainer=null,nota=0,preguntasSelect=[],respuestasSelect=[],valorRespuestaSelect=[],preguntasText=[],respuestasText=[],preguntasCheckBox=[],respuestasCheckBox=[],valorRespuestasCheckBox=[],preguntasRadio=[],respuestasRadio=[],preguntasSelectMultiple=[],respuestasSelectMultiple=[],imagen=document.createElement("img");imagen.setAttribute("src","../img/suspes.png"),window.onload=function(){formContainer=document.getElementById("myform"),formContainer.onsubmit=function(){return inicializar(),comprobar()&&(corregirSelect(),corregirText(),corregirCheckBox(),corregirRadio(),corregirSelectMultiple(),presentarNota()),!1};var e=new XMLHttpRequest;e.onreadystatechange=function(){4==this.readyState&&200==this.status&&gestionarXml(this)},e.open("GET","xml/preguntas.xml",!0),e.send()},window.onmousedown=function(e){var t=e.target;if("option"==t.tagName.toLowerCase()&&t.parentNode.hasAttribute("multiple")){e.preventDefault(),t.hasAttribute("selected")?t.removeAttribute("selected"):t.setAttribute("selected","");var a=t.parentNode.cloneNode(!0);t.parentNode.parentNode.replaceChild(a,t.parentNode)}};